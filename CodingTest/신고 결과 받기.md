```
import java.util.*;
class Solution {
    public int[] solution(String[] id_list, String[] report, int k) {
        HashSet<String> set = new HashSet<>();
        
        HashMap<String, List<String>> map = new HashMap<>();
        
        HashMap<String, Integer> dap = new HashMap<>();
        
        List<String> out = new ArrayList<>();
        
        for(String re : report){
            if(set.contains(re)) continue;
        
            String[] split = re.split(" ");
            
            if(!map.containsKey(split[1])) map.put(split[1], new ArrayList<>());
            
            List<String> list = map.get(split[1]); 
            list.add(split[0]);
            
            set.add(re);
        }
        
        for(String s : map.keySet()){
            if(map.get(s).size() >= k) out.add(s);
        }
        
        for(int i=0; i<out.size(); i++){
            String s = out.get(i);
            
            List<String> list = map.get(s);
            
            for(int j=0; j<list.size(); j++){
                dap.put(list.get(j), dap.getOrDefault(list.get(j), 0) + 1);
            }
        }
        
        int[] answer = new int[id_list.length];
        
        for(int i=0; i<id_list.length; i++){
            if(!dap.containsKey(id_list[i])) continue;
            
            answer[i] = dap.get(id_list[i]);
        }
        
        return answer;
    }
}
```
