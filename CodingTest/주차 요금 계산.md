```
import java.util.*;
class Solution {
    public int[] solution(int[] fees, String[] records) {
        HashMap<String, ArrayList<Integer>> map = new HashMap<>();
        
        for(String record : records){
            String[] split = record.split(" ");
            
            ArrayList<Integer> list = map.computeIfAbsent(split[1], k -> new ArrayList<>());
            list.add(parse(split[0]));
        }
        
        List<String> carList = new ArrayList<>(map.keySet());
        Collections.sort(carList);
        
        int[] dap = new int[carList.size()];
        
        for(int j = 0; j < carList.size(); j++){
            ArrayList<Integer> list = map.get(carList.get(j));
            
            if(list.size() % 2 == 1) list.add(parse("23:59"));
            
            int num = 0;
            for(int i = 0; i< list.size()-1; i+=2){
                num += list.get(i + 1) - list.get(i);
            }
            
            dap[j] = cal(num, fees); 
        }
        
        return dap;
    }
    
    int cal(int fee, int[] fees){
        if(fee <= fees[0]) return fees[1];
        
        return fees[1] + (fee - fees[0] + fees[2] - 1) / fees[2] * fees[3];
    }
    
    int parse(String time){
        String[] t = time.split(":");
        
        return Integer.parseInt(t[0]) * 60 + Integer.parseInt(t[1]);
    }
}
```
