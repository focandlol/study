```
import java.util.*;
import java.util.stream.*;
class Solution {
    HashMap<String, Integer> map = new HashMap<>();
    int[] max;
    public String[] solution(String[] orders, int[] course) {
        max = new int[course.length];
        
        for(int i=0; i<orders.length; i++){
            char[] c = orders[i].toCharArray();
            
            Arrays.sort(c);
            
            for(int j=0; j<course.length; j++){
                back(c, 0, 0, course[j], new StringBuilder(), j);
            }
        }
        
        ArrayList<String> list = new ArrayList<>();
        
        for(int i=0; i<course.length; i++){
            for(String s : map.keySet()){
                if(course[i] == s.length() && max[i] != 1 && map.get(s) == max[i]) list.add(s);
            }
        }
        
        return list.stream().sorted().toArray(String[]::new);
        
        
    }
    
    public void back(char[] c, int start, int depth, int stop, StringBuilder sb, int j){
        if(depth == stop){
            map.put(sb.toString(), map.getOrDefault(sb.toString(), 0) + 1);
            max[j] = Math.max(max[j], map.get(sb.toString()));
            return;
        }
        
        for(int i = start; i<c.length; i++){
            sb.append(c[i]);
            back(c, i + 1, depth + 1, stop, sb, j);
            sb.deleteCharAt(sb.length() -1);
        }
    }
}
```
