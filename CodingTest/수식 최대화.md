```
import java.util.*;
import java.util.stream.*;
class Solution {
    long max = 0;
    public long solution(String expression) {
        String[] numbers = expression.split("[+\\-*]");

        List<String> operators = Arrays.stream(expression.split("\\d+"))
            .filter(s -> !s.isEmpty())
            .collect(Collectors.toList());

        List<String> result = new ArrayList<>();
        
        for (int i = 0; i < numbers.length; i++) {
            result.add(numbers[i]);
            if (i < operators.size()) {
                result.add(operators.get(i));
            }
        }
        
        String[] arr = {"+","-","*"};
        
        back(result, arr, new boolean[3], 0);
        
        return max;
    }
    
    public void back(List<String> result, String[] arr, boolean[] visited, int depth){
        if(depth == 3){
            max = Math.max(max, Math.abs(Long.parseLong(result.get(0))));
            return;
        }
        
        for(int i=0; i<arr.length; i++){
            if(visited[i]) continue;
            
            ArrayDeque<String> deque = new ArrayDeque<>();
            for(int j=0; j<result.size(); j++){
                if(result.get(j).equals(arr[i])){
                    String gap = cal(deque.pollLast(), result.get(++j), arr[i]);
                    deque.add(gap);
                    continue;
                }
                deque.add(result.get(j));
            }
            
            ArrayList<String> list = new ArrayList<>();
            while(!deque.isEmpty()){
                list.add(deque.poll());
            }
            
            visited[i] = true;
            
            back(list, arr, visited, depth + 1);
            
            visited[i] = false;
            
        }
    }
    
    public String cal(String first, String last, String c){
        if(c.equals("*")){
            return String.valueOf(Long.parseLong(first) * Long.parseLong(last));
        }else if(c.equals("+")){
            return String.valueOf(Long.parseLong(first) + Long.parseLong(last));
        }else{
            return String.valueOf(Long.parseLong(first) - Long.parseLong(last));
        }
    }
}
```
