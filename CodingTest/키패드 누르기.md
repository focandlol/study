```
import java.util.*;
class Solution {
    public String solution(int[] numbers, String hand) {
        Map<Integer, int[]> map = new HashMap<>();
        
        int x = 0;
        int y = 0;
        
        for(int i=1; i<=9; i++){
            map.put(i, new int[]{x,y++});
            
            if(y >= 3){
                x++;
                y = 0;
            }
        }
        
        map.put(0, new int[]{3,1});
        map.put(-1, new int[]{3,0});
        map.put(-2, new int[]{3,2});
        
        int left = -1;
        int right = -2;
        
        StringBuilder sb = new StringBuilder();
        for(int i=0; i<numbers.length; i++){
            int num = numbers[i];
            
            if(num == 1 || num == 4 || num == 7){
                left = num;
                sb.append("L");
            }else if(num == 3 || num == 6 || num == 9){
                right = num;
                sb.append("R");
            }else{
                int[] l = map.get(left);
                int[] r = map.get(right);
                int[] n = map.get(num);
                
                int lCha = Math.abs(l[0] - n[0]) + Math.abs(l[1] - n[1]);
                int rCha = Math.abs(r[0] - n[0]) + Math.abs(r[1] - n[1]);
                
                if(lCha < rCha){
                    left = num;
                    sb.append("L");
                }else if(lCha > rCha){
                    right = num;
                    sb.append("R");
                }else{
                    if(hand.equals("left")){
                        left = num;
                        sb.append("L");
                    }else{
                        right = num;
                        sb.append("R");
                    }
                }
            }
        }
        return sb.toString();
    }
}
```
